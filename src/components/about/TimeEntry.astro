---
import moment from "moment";
import "moment/locale/de";

const { id, date, title, content, isLast = false } = Astro.props;

moment.locale("de");

let formattedDate: string;
if (date) {
  if (moment(date, "YYYY", true).isValid()) {
    formattedDate = moment(date, "YYYY").format("YYYY");
  } else if (moment(date, "YYYY-MM", true).isValid()) {
    formattedDate = moment(date, "YYYY-MM").format("MM.YYYY");
  } else if (moment(date, "YYYY-MM-DD", true).isValid()) {
    formattedDate = moment(date, "YYYY-MM-DD").format("DD.MM.YYYY");
  } else {
    formattedDate = moment(date).format("DD.MM.YYYY");
  }
} else {
  formattedDate = "Heute";
}

const showConnector = !isLast;
---

<article id={`entry-${id}`} class="group relative pl-10">
  <span
    class="absolute left-2 top-5 inline-flex h-3.5 w-3.5 items-center justify-center rounded-full border border-indigo-500/50 bg-white text-indigo-600 shadow-lg shadow-indigo-500/20 dark:border-indigo-400/60 dark:bg-slate-950 dark:text-indigo-200"
    aria-hidden="true"></span>
  {
    showConnector && (
      <span
        class="absolute left-[1.0625rem] top-8 bottom-0 w-px bg-gradient-to-b from-slate-900/20 via-slate-900/10 to-transparent dark:from-white/20 dark:via-white/5"
        aria-hidden="true"
      />
    )
  }

  <header
    class="flex items-center gap-4 text-xs uppercase tracking-[0.2em] text-indigo-600 dark:text-indigo-200"
  >
    <time
      datetime={date}
      class="text-sm font-semibold tracking-[0.3em] text-indigo-600 dark:text-indigo-100"
    >
      {formattedDate}
    </time>
    <div
      class="h-px flex-1 bg-gradient-to-r from-indigo-600/40 via-slate-900/20 to-transparent dark:from-indigo-400/40 dark:via-white/20"
    >
    </div>
  </header>

  <div
    class="mt-4 rounded-3xl border border-slate-900/10 bg-white px-6 py-6 text-gray-700 shadow-lg shadow-indigo-200/20 transition duration-300 group-hover:border-indigo-500/20 group-hover:shadow-indigo-500/30 dark:border-white/5 dark:bg-white/5 dark:text-gray-200 dark:shadow-indigo-500/10 dark:group-hover:border-white/10 dark:group-hover:shadow-indigo-500/20"
  >
    <h3 class="text-2xl font-semibold text-gray-900 dark:text-white">
      {title}
    </h3>
    <p class="mt-3 text-base leading-7 text-gray-600 dark:text-gray-300">
      {content}
    </p>
  </div>
</article>
