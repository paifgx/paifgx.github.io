---
interface Props {
  id: number;
  date?: string;
  endDate?: string;
  title: string;
  content: string;
  isLast?: boolean;
}

const {
  id,
  date,
  endDate,
  title,
  content,
  isLast = false,
} = Astro.props as Props;

function formatSingleDate(dateStr: string | undefined): string {
  if (!dateStr) {
    return "heute";
  }

  const parts = dateStr.split("-");

  if (parts.length === 1) {
    return parts[0];
  }

  if (parts.length === 2) {
    return `${parts[1]}/${parts[0]}`;
  }

  if (parts.length === 3) {
    return `${parts[1]}/${parts[0]}`;
  }

  return dateStr;
}

function formatDateRange(
  start: string | undefined,
  end: string | undefined
): string {
  const startFormatted = formatSingleDate(start);
  const endFormatted = formatSingleDate(end);

  return `${startFormatted} â€“ ${endFormatted}`;
}

const formattedDate = formatDateRange(date, endDate);
const showConnector = !isLast;
---

<article id={`entry-${id}`} class="group relative pl-10">
  <span
    class="absolute left-4 top-5 inline-flex h-3.5 w-3.5 -translate-x-1/2 items-center justify-center rounded-full border border-brand-blue/50 bg-white text-brand-blue shadow-lg shadow-brand-blue/20 dark:border-brand-gold/60 dark:bg-slate-950 dark:text-brand-gold"
    aria-hidden="true"></span>
  {
    showConnector && (
      <span
        class="absolute left-4 top-8 bottom-0 w-px -translate-x-1/2 bg-linear-to-b from-slate-900/20 via-slate-900/10 to-transparent dark:from-white/20 dark:via-white/5"
        aria-hidden="true"
      />
    )
  }

  <header
    class="flex items-center gap-4 text-xs uppercase tracking-[0.2em] text-brand-blue dark:text-brand-gold"
  >
    <time
      datetime={date}
      class="text-sm font-semibold tracking-[0.3em] text-brand-blue dark:text-brand-gold"
    >
      {formattedDate}
    </time>
    <div
      class="h-px flex-1 bg-linear-to-r from-brand-blue/40 via-slate-900/20 to-transparent dark:from-brand-gold/40 dark:via-white/20"
    >
    </div>
  </header>

  <div
    class="mt-4 rounded-3xl border border-slate-900/10 bg-white px-5 py-5 text-gray-700 shadow-lg shadow-brand-blue/10 transition duration-300 group-hover:border-brand-blue/20 group-hover:shadow-brand-blue/20 dark:border-white/5 dark:bg-white/5 dark:text-gray-200 dark:shadow-brand-gold/10 dark:group-hover:border-white/10 dark:group-hover:shadow-brand-gold/20 sm:px-6 sm:py-6"
  >
    <h3 class="text-xl font-semibold text-gray-900 dark:text-white sm:text-2xl">
      {title}
    </h3>
    <p class="mt-3 text-base leading-7 text-gray-600 dark:text-gray-300">
      {content}
    </p>
  </div>
</article>
