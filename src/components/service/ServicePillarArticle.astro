---
import type { ServicePillar } from "../../data/service";
import SkewedImage from "../ui/SkewedImage.astro";
import { createSlug } from "../../utils/slug";
import { iconMap } from "../../utils/icons";

interface Props {
  pillar: ServicePillar;
  isReversed?: boolean;
}

const { pillar, isReversed = false } = Astro.props;
const slugId = createSlug(pillar.title);
const clipPathId = `${slugId}-clip`;
const shapeId = `${slugId}-shape`;

// Icons for the three cards: Problem, Solution, Result
const CardIcons = [
  iconMap.ShieldExclamationIcon,
  iconMap.CommandLineIcon,
  iconMap.CheckBadgeIcon,
];
---

<article
  class="relative py-16 sm:py-24 border-b border-gray-100 last:border-0 dark:border-white/5 overflow-hidden"
  role="region"
  aria-labelledby={slugId}
>
  <!-- Background Elements -->
  <div
    aria-hidden="true"
    class="pointer-events-none absolute inset-0 opacity-40 dark:opacity-20 translate-y-1/4"
  >
    <div
      class={`absolute top-0 h-[500px] w-[500px] rounded-full bg-brand-blue/5 blur-[100px] ${isReversed ? "-right-24" : "-left-24"}`}
    >
    </div>
  </div>

  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 relative z-10">
    <div
      class={`flex flex-col gap-12 lg:gap-20 lg:flex-row items-center ${isReversed ? "lg:flex-row-reverse" : ""}`}
    >
      <!-- Content Side -->
      <div class="flex-1 space-y-8 lg:py-8">
        <div class="space-y-6">
          <span
            class="inline-flex items-center rounded-full border border-brand-blue/20 bg-brand-blue/5 px-4 py-1.5 text-xs font-bold uppercase tracking-widest text-brand-blue dark:border-brand-gold/20 dark:bg-brand-gold/5 dark:text-brand-gold shadow-sm"
          >
            {pillar.subtitle}
          </span>

          <h2
            id={slugId}
            class="text-3xl sm:text-4xl lg:text-5xl font-extrabold tracking-tight text-gray-900 dark:text-white"
          >
            {pillar.title}
          </h2>

          <p
            class="text-lg leading-relaxed text-gray-600 dark:text-gray-300 max-w-2xl"
          >
            {pillar.description}
          </p>
        </div>

        <div class="flex flex-col gap-5">
          {
            pillar.cards.map((card, index) => {
              const Icon = CardIcons[index];
              return (
                <div class="group relative flex flex-col gap-3 rounded-2xl border border-gray-200 bg-white p-6 shadow-sm transition-all duration-300 hover:shadow-lg hover:-translate-y-1 dark:border-white/10 dark:bg-white/5 dark:hover:border-white/20 dark:shadow-none">
                  <div class="flex items-center gap-3">
                    <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-xl bg-gray-50 text-gray-500 group-hover:bg-brand-blue/10 group-hover:text-brand-blue dark:bg-white/10 dark:text-gray-400 dark:group-hover:bg-brand-gold/10 dark:group-hover:text-brand-gold transition-colors">
                      {Icon && <Icon class="h-6 w-6" />}
                    </div>
                    <h3 class="text-xs font-bold uppercase tracking-wider text-gray-900 dark:text-white">
                      {card.title}
                    </h3>
                  </div>
                  <p class="text-sm leading-relaxed text-gray-600 dark:text-gray-400">
                    {card.description}
                  </p>
                </div>
              );
            })
          }
        </div>
      </div>

      <!-- Image Side -->
      <div class="w-full lg:flex-1 lg:max-w-xl">
        <div class="relative">
          <SkewedImage
            image={pillar.image}
            imageAlt={pillar.title}
            clipPathId={clipPathId}
            shapeId={shapeId}
          />
        </div>
      </div>
    </div>
  </div>
</article>
